---
title: "Migrate to Scalekit full-stack authentication"
description: "Step-by-step guide to move user, organization, and auth flows from existing systems to Scalekit."
sidebar:
  label: "Migrate to full stack auth"
head:
  - tag: style
    content: |
      .sl-markdown-content h2 {
        font-size: var(--sl-text-xl);
      }
      .sl-markdown-content h3 {
        font-size: var(--sl-text-lg);
      }
prev: false
---
import { Aside, Steps, Tabs, TabItem, LinkCard, Badge } from '@astrojs/starlight/components';
import InstallSDK from '@components/templates/_installsdk.mdx';

Migrating authentication is a big job. **But moving to Scalekit pays dividends**: you off-load password security, SSO integrations, SCIM provisioning, session handling, and more—so your team can focus on product. This guide walks you through a **safe, incremental migration** from any existing solution to **Scalekit's full-stack auth platform**.

This migration guide helps you:
- Export user and organization data from your current system
- Import data into Scalekit using APIs or SDKs
- Update your application's authentication flows
- Test and deploy the new authentication system

<Aside type="note" title="Need a hand?">
Our Solutions team has run dozens of successful migrations. If you store password hashes or need to migrate them, [contact us](/support/contact-us) and we'll craft a smooth cut-over plan together.
</Aside>

<Steps>

1. ### Audit and export your data

   Before migrating, create a comprehensive inventory of your existing setup and export your data:

   **Code audit:**
   - Sign-up and login flows
   - Session middleware and token validation
   - Role-based access control (RBAC) logic
   - Password reset and email verification flows
   - Logout and session termination

   **Data export:**
   - User records (emails, names, verification status)
   - Organization/tenant structure
   - Role assignments and permissions
   - Authentication provider configurations (if using SSO)

   **Backup plan:**
   - Export a sample JWT token or session cookie to understand your current format
   - Set up a feature flag to route traffic back to the old system if needed
   - Document your rollback procedure

   The minimal user schema looks like this:

   | **Field** | **Description** | **Status** |
   |-----------|-----------------|------------|
   | `email` | Primary login identifier. | Required |
   | `first_name` | The user's given name. | Optional |
   | `last_name` | The user's family name. | Optional |
   | `email_verified` | Boolean flag. Treated as `false` if omitted. | Optional |
   | `password_hash` | Bcrypt/Argon hash if you provide passwords. | Optional |

   <Aside type="caution" title="Passwords">If you need to keep users' existing passwords, please reach out. We offer a zero-downtime hash-migration flow that preserves security and user experience.</Aside>

2. ### Import organizations and users

   Transform your exported data to match Scalekit's format. The `external_id` field is crucial—it stores your original primary key, enabling seamless lookups between your system and Scalekit.

   <InstallSDK />

   **Create organizations first:**

   <Tabs syncKey="tech-stack">
   <TabItem label="Node.js" value="nodejs">
   ```javascript title="Create organizations"
   const organizations = [
     { display_name: "Megasoft Inc", external_id: "org_123", metadata: { plan: "enterprise" } },
     { display_name: "Acme Corp", external_id: "org_456", metadata: { plan: "starter" } }
   ];

   for (const org of organizations) {
     const result = await scalekit.organization.createOrganization(
       org.display_name,
       {
         externalId: org.external_id,
         metadata: org.metadata
       }
     );
     console.log(`Created organization: ${result.id}`);
   }
   ```
   </TabItem>
   <TabItem label="Python" value="python">
   ```python title="Create organizations"
   from scalekit.v1.organizations.organizations_pb2 import CreateOrganization

   organizations = [
     {"display_name": "Megasoft Inc", "external_id": "org_123", "metadata": {"plan": "enterprise"}},
     {"display_name": "Acme Corp", "external_id": "org_456", "metadata": {"plan": "starter"}}
   ]

   for org in organizations:
     result = scalekit_client.organization.create_organization(
       CreateOrganization(
         display_name=org["display_name"],
         external_id=org["external_id"],
         metadata=org["metadata"]
       )
     )
     print(f"Created organization: {result.id}")
   ```
   </TabItem>
   <TabItem label="Go" value="go">
   ```go title="Create organizations"
   organizations := []struct {
     DisplayName string
     ExternalID  string
     Metadata    map[string]interface{}
   }{
     {"Megasoft Inc", "org_123", map[string]interface{}{"plan": "enterprise"}},
     {"Acme Corp", "org_456", map[string]interface{}{"plan": "starter"}},
   }

   for _, org := range organizations {
     result, err := scalekit.Organization.CreateOrganization(
       ctx,
       org.DisplayName,
       scalekit.CreateOrganizationOptions{
         ExternalID: org.ExternalID,
         Metadata:   org.Metadata,
       },
     )
     if err != nil {
       log.Fatal(err)
     }
     fmt.Printf("Created organization: %s\n", result.ID)
   }
   ```
   </TabItem>
   <TabItem label="Java" value="java">
   ```java title="Create organizations"
   List<Map<String, Object>> organizations = Arrays.asList(
     Map.of("display_name", "Megasoft Inc", "external_id", "org_123", "metadata", Map.of("plan", "enterprise")),
     Map.of("display_name", "Acme Corp", "external_id", "org_456", "metadata", Map.of("plan", "starter"))
   );

   for (Map<String, Object> org : organizations) {
     CreateOrganization createOrganization = CreateOrganization.newBuilder()
       .setDisplayName((String) org.get("display_name"))
       .setExternalId((String) org.get("external_id"))
       .putAllMetadata((Map<String, String>) org.get("metadata"))
       .build();

     Organization result = scalekitClient.organizations().create(createOrganization);
     System.out.println("Created organization: " + result.getId());
   }
   ```
   </TabItem>
   <TabItem label="cURL" value="curl">
   ```bash title="Create an organization"
   curl "$SCALEKIT_ENVIRONMENT_URL/api/v1/organizations" \
     --request POST \
     --header 'Content-Type: application/json' \
     --data '{
       "display_name": "Megasoft Inc",
       "external_id": "org_123",
       "metadata": { "plan": "enterprise" }
     }'
   ```
   </TabItem>
   </Tabs>

   **Then create users within organizations:**

   <Tabs syncKey="tech-stack">
   <TabItem label="Node.js" value="nodejs">
   ```javascript title="Create users in organizations"
   const { user } = await scalekit.user.createUserAndMembership("org_123", {
     email: "user@example.com",
     externalId: "usr_987",
     metadata: {
       department: "engineering",
       location: "nyc-office"
     },
     userProfile: {
       firstName: "John",
       lastName: "Doe",
     },
   });
   ```
   </TabItem>
   <TabItem label="Python" value="python">
   ```python title="Create users in organizations"
   from scalekit.v1.users.users_pb2 import CreateUser
   from scalekit.v1.commons.commons_pb2 import UserProfile

   user_msg = CreateUser(
     email="user@example.com",
     external_id="usr_987",
     metadata={"department": "engineering", "location": "nyc-office"},
     user_profile=UserProfile(
       first_name="John",
       last_name="Doe"
     )
   )

   create_resp, _ = scalekit_client.user.create_user_and_membership("org_123", user_msg)
   ```
   </TabItem>
   <TabItem label="Go" value="go">
   ```go title="Create users in organizations"
   newUser := &usersv1.CreateUser{
     Email:      "user@example.com",
     ExternalId: "usr_987",
     Metadata: map[string]string{
       "department": "engineering",
       "location":   "nyc-office",
     },
     UserProfile: &usersv1.CreateUserProfile{
       FirstName: "John",
       LastName:  "Doe",
     },
   }

   cuResp, err := scalekit.User().CreateUserAndMembership(ctx, "org_123", newUser, false)
   if err != nil {
     log.Fatal(err)
   }
   ```
   </TabItem>
   <TabItem label="Java" value="java">
   ```java title="Create users in organizations"
   CreateUser createUser = CreateUser.newBuilder()
     .setEmail("user@example.com")
     .setExternalId("usr_987")
     .putMetadata("department", "engineering")
     .putMetadata("location", "nyc-office")
     .setUserProfile(
       CreateUserProfile.newBuilder()
         .setFirstName("John")
         .setLastName("Doe")
         .build())
     .build();

   CreateUserAndMembershipResponse cuResp = scalekitClient.users()
     .createUserAndMembership("org_123", createUser);
   System.out.println("Created user: " + cuResp.getUser().getId());
   ```
   </TabItem>
   <TabItem label="cURL" value="curl">
   ```bash title="Create a user inside an organization"
   curl "$SCALEKIT_ENVIRONMENT_URL/api/v1/organizations/{organization_id}/users" \
     --request POST \
     --header 'Content-Type: application/json' \
     --data '{
       "email": "user@example.com",
       "external_id": "usr_987",
       "membership": {
         "roles": ["admin"],
         "metadata": { "department": "engineering" }
       },
       "user_profile": {
         "first_name": "John",
         "last_name": "Doe",
         "locale": "en-US"
       }
     }'
   ```
   </TabItem>
   </Tabs>

   **Import tips:**
   - **Batch** your imports—run them in parallel for speed but respect rate limits
   - Pass `email_verified=true` if you already trust the address
   - Map existing app roles to Scalekit roles up-front (see step 4)
   <br/>

3. ### Configure redirects and roles

   **Register callback URLs:**
   Your app must be listed as an **Allowed Callback URL** so tokens return safely. Head to **Settings → Redirects** in the dashboard or update them via the API.

   **Set up roles:**
   - Create your roles under **User Management → Roles** or via the SDK
   - While importing users, include the `roles` array in the `membership` object
   - Need tenant-specific roles? [Contact us](/support/contact-us)—we support per-org role templates
   <br/>

4. ### Update your application code

   **Replace session middleware:**
   Replace legacy JWT validation with the Scalekit SDK or our **JWKS endpoint**. Verify:
   - Access tokens are accepted across all routes
   - Refresh tokens renew seamlessly
   - [Role checks read](/fsa/guides/app-roles/) from the `roles` claim

   <Aside type="tip">Use our language SDKs for drop-in middlewares in Node, Go, Python, and Java.</Aside>

   **Choose your login UI:**
   1. **Scalekit-hosted** (fastest)
   2. **Embedded modal**—drop in our React/Vue component <Badge type="tip" text="Coming soon"/>
   3. **Fully custom**—call the SDK directly

   All three options work with the same backend you just configured.

   **Update secondary flows:**
   - Forgot / Change password screens (if using passwords)
   - Verify email prompt
   - [Branding (logo, colours, legal copy)](/fsa/guides/login-page-branding/)
   <br />

5. ### Deploy and monitor
   Execute your migration carefully with proper monitoring:

   **Pre-deployment testing:**
   - Test login flows with a few migrated users
   - Verify session management and token validation
   - Check role-based access control

   **Deployment steps:**
   1. Deploy your updated application code
   2. Enable the feature flag to route traffic to Scalekit
   3. Monitor authentication success rates and error logs
   4. Have your rollback plan ready

   **Post-deployment monitoring:**
   - Watch authentication error rates
   - Monitor session creation and validation
   - Check user feedback and support tickets
   - Verify SSO connections work correctly

   <Aside type="tip">Start with a small percentage of users (5-10%) before rolling out to everyone.</Aside>

</Steps>

## Troubleshooting common issues

**Users can't log in after migration:**
- Verify callback URLs are registered in Scalekit dashboard
- Check that `external_id` mappings are correct
- Ensure email addresses match exactly between systems

**Session validation fails:**
- Update JWT validation to use Scalekit's JWKS endpoint
- Verify token expiration and refresh logic
- Check that role claims are read correctly

**SSO connections not working:**
- Confirm organization has SSO enabled in features
- Verify identity provider configuration
- Test with IdP-initiated login

**Need help?** [Contact our support team](/support/contact-us) with your specific error messages and we'll help troubleshoot.