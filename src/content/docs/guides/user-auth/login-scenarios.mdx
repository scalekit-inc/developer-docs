---
title: 'Customize login flows'
description:
  'Learn how to handle different login, re-authentication, and signup scenarios by passing parameters to the authorization URL'
browseCentral:
  label: "Pass parameters for varied auth scenarios"
  filterType: ["tutorial"]
  category: ["User authentication"]
  icon: "book"
sidebar:
  label: 'Customize login flows'
prev:
  link: '/guides/dashboard/intitate-login-endpoint/'
  label: 'Configure login endpoint'
next:
  link: '/guides/dashboard/redirects/'
  label: 'Configure redirect URLs'
seeAlso:
  label: 'Related guides'
  items:
    - title: 'Preserve intended destination'
      icon: 'book'
      url: '/guides/user-auth/preserve-intended-destination'
    - title: 'Add CSRF protection with the state'
      icon: 'book'
      url: '/guides/security/csrf-protection'
---

import { Tabs, TabItem, Aside, Steps } from '@astrojs/starlight/components';

When you implement login, you generate an authorization URL that redirects users to a Scalekit-hosted login page. You can customize the user's journey by passing different parameters when creating this URL.

This guide covers common scenarios like routing users to their organization's identity provider or prompting for re-authentication.

<Aside type="note" title="Routing precedence">
  Scalekit applies connection selection in this order: `connection_id` → `organizationId` →
  `loginHint` (domain extraction). Prefer the highest confidence signal you have.
</Aside>

<Steps>
1. ## Route users to a specific organization

   For multi-tenant applications, you can route users directly to their organization's authentication method using `organizationId`. This is useful when you already know the user's organization.

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {5}
       const orgId = getOrganizationFromRequest(req)
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = {
         scopes: ['openid', 'profile', 'email', 'offline_access'],
         organizationId: orgId,
       }
       const url = scalekit.getAuthorizationUrl(redirectUri, options)
       return res.redirect(url)
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {5}
       from scalekit import AuthorizationUrlOptions

       org_id = get_org_from_request(request)
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], organization_id=org_id)
       url = scalekit_client.get_authorization_url(redirect_uri, options)
       return redirect(url)
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {4}
       orgID := getOrgFromRequest(c)
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, OrganizationId: orgID}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {5}
       String orgId = getOrgFromRequest(request);
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setOrganizationId(orgId);
       URL url = scalekitClient.authentication().getAuthorizationUrl(redirectUri, options);
       return new RedirectView(url.toString());
       ```
     </TabItem>
   </Tabs>

2. ## Route users based on email domain

   If you don't know the organization beforehand, you can use `loginHint` to let Scalekit determine the correct authentication method from the user's email domain. This is common for enterprise logins where the email domain is associated with a specific SSO connection. The domain must be registered to the organization either manually from the Scalekit Dashboard or through the admin portal when [onboarding an enterprise customer](/fsa/guides/onboard-enterprise-customers/).

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {3}
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = { scopes: ['openid', 'profile', 'email', 'offline_access'], loginHint: userEmail }
       const url = scalekit.getAuthorizationUrl(redirectUri, options)
       return res.redirect(url)
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {3}
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], login_hint=user_email)
       url = scalekit_client.get_authorization_url(redirect_uri, options)
       return redirect(url)
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {3}
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, LoginHint: userEmail}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {4}
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setLoginHint(userEmail);
       URL url = scalekitClient.authentication().getAuthorizationUrl(redirectUri, options);
       return new RedirectView(url.toString());
       ```
     </TabItem>
   </Tabs>

3. ## Route users to a specific SSO connection

   When you know the exact enterprise connection a user should use, you can pass its `connectionId` for the highest routing precision. This bypasses any other routing logic.

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {3}
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = { scopes: ['openid', 'profile', 'email', 'offline_access'], connectionId: 'conn_123...' }
       const url = scalekit.getAuthorizationUrl(redirectUri, options)
       return res.redirect(url)
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {3}
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], connection_id='conn_123...')
       url = scalekit_client.get_authorization_url(redirect_uri, options)
       return redirect(url)
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {3}
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, ConnectionId: "conn_123..."}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {4}
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setConnectionId("conn_123...");
       URL url = scalekitClient.authentication().getAuthorizationUrl(redirectUri, options);
       return new RedirectView(url.toString());
       ```
     </TabItem>
   </Tabs>

4. ## Force users to re-authenticate

   You can require users to authenticate again, even if they have an active session, by setting `prompt: 'login'`. This is useful for high-security actions that require recent authentication.

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {3}
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = { scopes: ['openid', 'profile', 'email', 'offline_access'], prompt: 'login' }
       return res.redirect(scalekit.getAuthorizationUrl(redirectUri, options))
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {3}
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], prompt='login')
       return redirect(scalekit_client.get_authorization_url(redirect_uri, options))
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {3}
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, Prompt: "login"}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {4}
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setPrompt("login");
       return new RedirectView(scalekitClient.authentication().getAuthorizationUrl(redirectUri, options).toString());
       ```
     </TabItem>
   </Tabs>

5. ## Let users choose an account or organization

   To show the organization or account chooser, set `prompt: 'select_account'`. This is helpful when a user is part of multiple organizations and needs to select which one to sign into.

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {3}
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = { scopes: ['openid', 'profile', 'email', 'offline_access'], prompt: 'select_account' }
       return res.redirect(scalekit.getAuthorizationUrl(redirectUri, options))
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {3}
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], prompt='select_account')
       return redirect(scalekit_client.get_authorization_url(redirect_uri, options))
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {3}
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, Prompt: "select_account"}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {4}
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setPrompt("select_account");
       return new RedirectView(scalekitClient.authentication().getAuthorizationUrl(redirectUri, options).toString());
       ```
     </TabItem>
   </Tabs>

6. ## Send users directly to signup

   To send users directly to the signup form instead of the login page, use `prompt: 'create'`.

   <Tabs syncKey="tech-stack">
     <TabItem value="node" label="Node.js">
       ```javascript title="Express.js" {3}
       const redirectUri = 'https://your-app.com/auth/callback'
       const options = { scopes: ['openid', 'profile', 'email', 'offline_access'], prompt: 'create' }
       return res.redirect(scalekit.getAuthorizationUrl(redirectUri, options))
       ```
     </TabItem>
     <TabItem value="python" label="Python">
       ```python title="Flask" {3}
       redirect_uri = 'https://your-app.com/auth/callback'
       options = AuthorizationUrlOptions(scopes=['openid','profile','email','offline_access'], prompt='create')
       return redirect(scalekit_client.get_authorization_url(redirect_uri, options))
       ```
     </TabItem>
     <TabItem value="go" label="Go">
       ```go title="Gin" {3}
       redirectUri := "https://your-app.com/auth/callback"
       options := scalekitClient.AuthorizationUrlOptions{Scopes: []string{"openid","profile","email","offline_access"}, Prompt: "create"}
       url, _ := scalekitClient.GetAuthorizationUrl(redirectUri, options)
       c.Redirect(http.StatusFound, url.String())
       ```
     </TabItem>
     <TabItem value="java" label="Java">
       ```java title="Spring" {4}
       String redirectUri = "https://your-app.com/auth/callback";
       AuthorizationUrlOptions options = new AuthorizationUrlOptions();
       options.setScopes(Arrays.asList("openid","profile","email","offline_access"));
       options.setPrompt("create");
       return new RedirectView(scalekitClient.authentication().getAuthorizationUrl(redirectUri, options).toString());
       ```
     </TabItem>
   </Tabs>

</Steps>

<Aside type="caution" title="Always send state">
  Include a cryptographically strong `state` parameter and validate it on callback to prevent CSRF and session fixation attacks. See our guide on CSRF protection for details.
</Aside>