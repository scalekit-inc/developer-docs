---
title: Passwordless email headless API
description: Implement Email OTP or Magic Link with direct API calls, full control over UX
browseCentral:
  label: "API to ship Magic Link or OTP verifications"
  filterType: ["tutorial"]
  category: ["User authentication"]
  icon: book
sidebar:
  label: 'Build passwordless auth'
badge:
   text: 'Headless'
head:
  - tag: style
    content: |
      table td:not(:last-child), table th:not(:last-child) {
        white-space: nowrap;
      }
      .sl-markdown-content h2 {
        font-size: var(--sl-text-xl);
      }
seeAlso:
  items:
    - title: "Customize email templates"
      icon: "blog"
      url: "/guides/dashboard/custom-email-templates"
    - title: "Express.js example app"
      icon: "nodejs"
      url: "https://github.com/scalekit-developers/blogops-app-examples/tree/main/express-passwordless-auth"
    - title: "Vue, React, Next and Solid examples"
      url: "https://github.com/scalekit-developers/blogops-app-examples/tree/main"
    - title: "Spring Boot implementation guide"
      icon: java
      url: "https://www.scalekit.com/blog/spring-boot-3-passwordless-authentication-scalekit"
    - title: "View auth logs"
      icon: "blog"
      url: "/guides/dashboard/auth-logs"
  expanded: false
  label: "More passwordless resources"
next:
  label: "Continue to build session management"
  link: "/authenticate/fsa/manage-session/"
prev:
  label: "Setup Scalekit"
  link: "/authenticate/installation"
---

import { Aside, Badge, LinkCard, Steps, TabItem, Tabs } from '@astrojs/starlight/components';
import Card from '@/components/ui/Card.astro';
import CopyPrompt from '@components/ui/CopyPrompt.astro';
import { VideoPlayer } from 'starlight-videos/components';
import IconLucidePlay from '~icons/lucide/play'
import IconTdesignSequence from '~icons/tdesign/sequence'
import IconRiAiGenerate2 from '~icons/ri/ai-generate-2'
import InstallSDK from '@components/templates/_installsdk.mdx'

This guide explains how you can implement passwordless authentication using Scalekit's headless APIs to send either verification codes or magic links to your user's email address and verify their identity. You have full control over all UI components and user flows in your application, while Scalekit provides the backend authentication infrastructure.

<details>
<summary><IconLucidePlay style="display: inline; width: 1rem; height: 1rem; vertical-align: middle; margin-right: 0.5rem;" /> See the integration in action</summary>

<VideoPlayer link="https://youtu.be/8e4ZH-Aemg4" />

</details>

<details>
<summary><IconTdesignSequence style="display: inline; width: 1rem; height: 1rem; vertical-align: middle; margin-right: 0.5rem;" /> Review the authentication sequence</summary>

Coming soon

</details>

<Card title="Get moving, instantly, with your go-to AI assistant" icon={IconRiAiGenerate2}>
  <div style={{display: 'flex',  alignItems: 'center', justifyContent: 'space-between', gap: '0.5rem'}}>
    <div style={{flex: '3'}}>
      <p>Input this prompt in your IDE to analyze your existing code base and generate Passwordless auth implementation code accordingly.</p>

      <span style={{fontSize: '0.875rem', color: '#6b7280', fontStyle: 'italic', paddingTop: '0.05rem', }}>
        *Compatible with Cursor, Windsurf, VS Code, and any AI-powered tools
      </span>
    </div>
    <div style={{flex: '1'}}>
      <CopyPrompt
        promptType="headlessPasswordlessQuickstartPrompt"
            label="Copy prompt"
        className="sk-secondary"
        variant="secondary"
        title="Generate Passwordless integration code"
      />
    </div>
  </div>
</Card>

-------


<Steps>

1. ## Set up Scalekit

   Install the Scalekit SDK to your project.

   <InstallSDK />

   Your application is responsible for verifying users and initiating sessions, while Scalekit securely manages authentication tokens to ensure the verification process is completed successfully

2. ## Configure passwordless settings

   In the Scalekit dashboard, enable passwordless and choose your login method.

   Optional security settings:
   - **Enforce same-browser origin**: Users must complete magic-link auth in the same browser they started in.
   - **Issue new credentials on resend**: Each resend generates a fresh code or link and invalidates the previous one.

    ![](@/assets/docs/unlisted/passwordless/1-v2.png)

3. ## Send verification email

    The first step in the passwordless flow is to send a verification email to the user's email. This verification email contains either a **one-time passcode or a magic link or both** based on your selection in the Scalekit dashboard (earlier step).

    Follow these steps to implement the verification email flow:

    1. Create a form to collect the user's email address
    2. Call the passwordless API when the form is submitted
    3. Handle the response to provide feedback to the user

    ```http showLineNumbers=false title="API endpoint"
    POST /api/v1/passwordless/email/send
    ```

    **Example implementation**

    <Tabs syncKey='tech-stack'>
   <TabItem label="cURL" value="curl">
    ```sh {11} "/api/v1/passwordless/email/send" title="Send a passwordless verification code to user's email" { "Only if Link or Link+OTP as passwordless option": 9} collapse={17-22}
      curl -L '<SCALEKIT_ENVIRONMENT_URL>/api/v1/passwordless/email/send' \
      -H 'Content-Type: application/json' \
      -H 'Authorization: Bearer eyJh..' \
      --data-raw '{
          "email": "john.doe@example.com",
          "expires_in": 300,
          "state": "jAy-state1-gM4fdZ...2nqm6Q",
          "template": "SIGNIN",

          "magiclink_auth_uri": "https://yourapp.com/passwordless/verify",
          "template_variables": {
            "custom_variable_key": "custom_variable_value"
          }
      }'

    # Response
    # {
    # "auth_request_id": "jAy-state1-gM4fdZ...2nqm6Q"
    # "expires_at": "1748696575"
    # "expires_in": 100
    # "passwordless_type": "OTP" | "LINK" | "LINK_OTP"
    # }

    ```
    <details>
      <summary>Request parameters</summary>

      | Parameter  | Required | Description |
      |------------|----------|-------------|
      | `email` | Yes | Recipient's email address <Badge variant="note" text="string" /> |
      | `expires_in` | No | Code expiration time in seconds (default: 300) <Badge variant="note" text="number" /> |
      | `state` | No | OIDC state parameter for request validation <Badge variant="note" text="string" /> |
      | `template` | No | Email template to use (`SIGNIN` or `SIGNUP`) <Badge variant="note" text="string" /> |
      | `magiclink_auth_uri` | No | Magic Link URI that will be sent to your user to complete the authentication flow. If the URL is of the format `https://yourapp.com/passwordless/verify`, the magic link sent to your user via email will be `https://yourapp.com/passwordless/verify?link_token=<link_token>`. Required if you selected Link or Link + OTP as the passwordless option.<Badge variant="note" text="string" /> |
      | `template_variables` | No | Pass variables to be used in the email template sent to the user. You may include up to 30 key-value pairs to reference in the email template. <Badge variant="note" text="object" /> |
    </details>

    <details>
      <summary>Response parameters</summary>

      | Parameters | Description |
      |-----------|-------------|
      | `auth_request_id` | A unique identifier for the authentication request that can be used to verify the code <Badge variant="note" text="string" /> |
      | `expires_at` | Unix timestamp indicating when the verification code will expire <Badge variant="note" text="string" /> |
      | `expires_in` | The time in seconds after which the verification code will expire. Default is 100 seconds <Badge variant="note" text="number" /> |
      | `passwordless_type` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
    </details>

   </TabItem>
   <TabItem label="Node.js" value="node">
    ```js wrap
    const options = {
      template: "SIGNIN",
      state: "jAy-state1-...2nqm6Q",
      expiresIn: 300,
      // Required if you selected Link or Link+OTP as passwordless option
      magiclinkAuthUri: "https://yourapp.com/passwordless/verify",
        templateVariables: {
            employeeID: "EMP523",
            teamName: "Alpha Team",
        },
    };

    const sendResponse = await scalekit.passwordless
      .sendPasswordlessEmail(
        "<john.doe@example.com>",
        options
    );

    // sendResponse = {
    //   authRequestId: string,
    //   expiresAt: number,    // seconds since epoch
    //   expiresIn: number,    // seconds
    //   passwordlessType: string  // "OTP" | "LINK" | "LINK_OTP"
    // }

    ```

     <details>
        <summary>Request parameters</summary>
      | Parameter | Required | Description |
      |-----------|----------|-------------|
      | `email` | Yes | The email address to send the passwordless link to <Badge variant="note" text="string" /> |
      | `template` | No | The template type (`SIGNIN`/`SIGNUP`) <Badge variant="note" text="string" /> |
      | `state` | No | Optional state parameter to maintain state between request and callback <Badge variant="note" text="string" /> |
      | `expiresIn` | No | Optional expiration time in seconds (default: 300) <Badge variant="note" text="number" /> |
      | `magiclinkAuthUri` | No | Magic Link URI that will be sent to your user to complete the authentication flow. If the URL is of the format `https://yourapp.com/passwordless/verify`, the magic link sent to your user via email will be `https://yourapp.com/passwordless/verify?link_token=<link_token>`. Required if you selected Link or Link + OTP as the passwordless option.<Badge variant="note" text="string" /> |
      | `template_variables` | No | Pass variables to be used in the email template sent to the user. You may include up to 30 key-value pairs to reference in the email template. <Badge variant="note" text="object" /> |

    </details>

    <details>
      <summary>Response parameters</summary>

      | Parameters | Description |
      |-----------|-------------|
      | `authRequestId` | Unique identifier for the passwordless authentication request <Badge variant="note" text="string" /> |
      | `expiresAt` | Expiration time in seconds since epoch <Badge variant="note" text="number" /> |
      | `expiresIn` | Expiration time in seconds <Badge variant="note" text="number" /> |
      | `passwordlessType` | Type of passwordless authentication (`OTP`, `LINK` or `LINK_OTP`) <Badge variant="note" text="string" /> |

    </details>
   </TabItem>
   <TabItem label="Python" value="python">
   ```python
   response = client.passwordless.send_passwordless_email(
       email="john.doe@example.com",
       template="SIGNIN",  # or "SIGNUP", "UNSPECIFIED"
       expires_in=300,
       magiclink_auth_uri="https://yourapp.com/passwordless/verify",
       template_variables={
           "employeeID": "EMP523",
           "teamName": "Alpha Team",
       },
   )

   # Extract auth request ID from response
   auth_request_id = response[0].auth_request_id
   ```
   </TabItem>
   <TabItem label="Go" value="go">
    ```go
    // Send a passwordless email (assumes you have an initialized `client` and `ctx`)
    templateType := scalekit.TemplateTypeSignin
    resp, err := scalekitClient.Passwordless().SendPasswordlessEmail(
      ctx,
      "john.doe@example.com",
      &scalekit.SendPasswordlessOptions{
        Template:          &templateType,
        State:             "jAy-state1-gM4fdZ...2nqm6Q",
        ExpiresIn:         300,
        MagiclinkAuthUri:  "https://yourapp.com/passwordless/verify", // required if Link or Link+OTP
        TemplateVariables: map[string]string{
          "employeeID": "EMP523",
          "teamName": "Alpha Team",
        },
      },
    )

    // resp contains: AuthRequestId, ExpiresAt, ExpiresIn, PasswordlessType
    ```
    <details>
      <summary>Request parameters</summary>
      | Parameter | Required | Description |
      |-----------|----------|-------------|
      | `email` | Yes | The email address to send the passwordless link to <Badge variant="note" text="string" /> |
      | `MagiclinkAuthUri` | No | Magic Link URI for authentication <Badge variant="note" text="string" /> |
      | `State` | No | Optional state parameter <Badge variant="note" text="string" /> |
      | `Template` | No | Email template type (`SIGNIN`/`SIGNUP`) <Badge variant="note" text="string" /> |
      | `ExpiresIn` | No | Expiration time in seconds <Badge variant="note" text="number" /> |
      | `TemplateVariables` | No | Key-value pairs for email template <Badge variant="note" text="object" /> |
    </details>
    <details>
      <summary>Response parameters</summary>
      | Parameters | Description |
      |-----------|-------------|
      | `AuthRequestId` | Unique identifier for the passwordless authentication request <Badge variant="note" text="string" /> |
      | `ExpiresAt` | Expiration time in seconds since epoch <Badge variant="note" text="number" /> |
      | `ExpiresIn` | Expiration time in seconds <Badge variant="note" text="number" /> |
      | `PasswordlessType` | Type of passwordless authentication (`OTP`, `LINK` or `LINK_OTP`) <Badge variant="note" text="string" /> |
    </details>
   </TabItem>
   <TabItem label="Java" value="java">
   ```java
   import java.util.HashMap;
   import java.util.Map;

   TemplateType templateType = TemplateType.SIGNIN;
   Map<String, String> templateVariables = new HashMap<>();
   templateVariables.put("employeeID", "EMP523");
   templateVariables.put("teamName", "Alpha Team");

   SendPasswordlessOptions options = new SendPasswordlessOptions();
   options.setTemplate(templateType);
   options.setExpiresIn(300);
   options.setMagiclinkAuthUri("https://yourapp.com/passwordless/verify");
   options.setTemplateVariables(templateVariables);

   SendPasswordlessResponse response = passwordlessClient.sendPasswordlessEmail(
       "john.doe@example.com",
       options
   );

   String authRequestId = response.getAuthRequestId();
   ```
   </TabItem>
    </Tabs>

3. ### Resend a verification email

    Users can request a new verification email if they need one. Use the following endpoint to send a fresh email to verify using OTP or Magic Link.

    <Tabs syncKey='tech-stack'>
   <TabItem label="cURL" value="curl">
    ```sh ins={5} "/api/v1/passwordless/email/resend" title="Request" wrap
    curl -L '<SCALEKIT_ENVIRONMENT_URL>/api/v1/passwordless/email/resend' \
    -H 'Content-Type: application/json' \
    -H 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsIm..' \
    -d '{
        "auth_request_id": "jAy-state1-gM4fdZ...2nqm6Q"
    }'

   # Response

   # {

   # "auth_request_id": "jAy-state1-gM4fdZ...2nqm6Q"

   # "expires_at": "1748696575"

   # "expires_in": 300

   # "passwordless_type": "OTP" | "LINK" | "LINK_OTP"

   # }

    ```

    <details>
      <summary>Request parameters</summary>

      | Parameters | Required | Description |
      |-----------|----------|-------------|
      | `auth_request_id` | Yes | The unique identifier for the authentication request that was sent earlier <Badge variant="note" text="string" /> |
    </details>

    <details>
      <summary>Response parameters</summary>

      | Parameters | Description |
      |-----------|-------------|
      | `auth_request_id` | A unique identifier for the authentication request that can be used to verify the code <Badge variant="note" text="string" /> |
      | `expires_at` | Unix timestamp indicating when the verification code will expire <Badge variant="note" text="string" /> |
      | `expires_in` | The time in seconds after which the verification code will expire. Default is 300 seconds <Badge variant="note" text="number" /> |
      | `passwordless_type` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
    </details>
   </TabItem>
   <TabItem label="Node.js" value="node">
    ```js
    const { authRequestId } = sendResponse;
    const resendResponse = await scalekit.passwordless
    .resendPasswordlessEmail(
        authRequestId
    );

    // resendResponse = {
    //   authRequestId: "jAy-state1-gM4fdZ...2nqm6Q",
    //   expiresAt: "1748696575",
    //   expiresIn: "300",
    //   passwordlessType: "OTP" | "LINK" | "LINK_OTP"
    // }
    ```

    <details>
      <summary>Request parameters</summary>

      | Parameters | Required | Description |
      |-----------|----------|-------------|
      | `authRequestId` | Yes | The unique identifier for the authentication request that was sent earlier <Badge variant="note" text="string" /> |

    </details>

    <details>
      <summary>Response parameters</summary>

      | Parameters | Description |
      |-----------|-------------|
      | `authRequestId` | Unique identifier for the passwordless authentication request <Badge variant="note" text="string" /> |
      | `expiresAt` | Expiration time in seconds since epoch <Badge variant="note" text="number" /> |
      | `expiresIn` | Expiration time in seconds. Default is 300 seconds <Badge variant="note" text="number" /> |
      | `passwordlessType` | `OTP`, `LINK` or `LINK_OTP` <Badge variant="note" text="string" /> |

    </details>
   </TabItem>
   <TabItem label="Python" value="python">
   ```python
   resend_response = client.passwordless.resend_passwordless_email(
       auth_request_id=auth_request_id,
   )

   new_auth_request_id = resend_response[0].auth_request_id
   ```
   </TabItem>
   <TabItem label="Go" value="go">
    ```go
    // Resend passwordless email for an existing auth request
    resendResp, err := scalekitClient.Passwordless().ResendPasswordlessEmail(
      ctx,            // context.Context (e.g., context.Background())
      authRequestId,  // string: from the send email response
    )

    if err != nil {
      // handle error (log, return HTTP 400/500, etc.)
      // ...
    }

    // resendResp is a pointer to ResendPasswordlessResponse struct:
    // type ResendPasswordlessResponse struct {
    //   AuthRequestId    string // Unique ID for the passwordless request
    //   ExpiresAt        int64  // Unix timestamp (seconds since epoch)
    //   ExpiresIn        int    // Expiry duration in seconds
    //   PasswordlessType string // "OTP", "LINK", or "LINK_OTP"
    // }
    ```

    <details>
      <summary>Request parameters</summary>

      | Parameters | Required | Description |
      |-----------|----------|-------------|
      | `authRequestId` | Yes | The unique identifier for the authentication request that was sent earlier <Badge variant="note" text="string" /> |

    </details>

    <details>
      <summary>Response parameters</summary>

      | Parameters | Description |
      |-----------|-------------|
      | `AuthRequestId` | Unique identifier for the passwordless authentication request <Badge variant="note" text="string" /> |
      | `ExpiresAt` | Expiration time in seconds since epoch <Badge variant="note" text="number" /> |
      | `ExpiresIn` | Expiration time in seconds. Default is 300 seconds <Badge variant="note" text="number" /> |
      | `PasswordlessType` | `OTP`, `LINK` or `LINK_OTP` <Badge variant="note" text="string" /> |

    </details>
   </TabItem>
   <TabItem label="Java" value="java">
   ```java wrap showLineNumbers=false
   SendPasswordlessResponse resendResponse = passwordlessClient.resendPasswordlessEmail(authRequestId);
   ```
   </TabItem>
    </Tabs>

    If you enabled **Enable new passwordless credentials on resend** in the Scalekit dashboard, a new verification code or magic link will be sent each time the user requests a new one.

    <Aside type="caution" title="Rate limits">
      Scalekit enforces a rate limit of 2 passwordless emails per minute per email address. This limit includes both initial sends and resends.
    </Aside>

4. ### Verify the user's identity

    Once the user receives the verification email,
    - If it's Verification code, they'll enter it in your application. Use the following endpoint to validate the code and complete the authentication process.
    - If it's Magic Link, they'll click the link in the email to verify their email address. Capture the `link_token` request parameter from the URL and use it to verify the user's email address.
    - For additional security with magic links, if you enabled the option "Enforce same browser origin", you are required to send the `auth_request_id` to the verification endpoint.

    <Tabs syncKey='verification-type'>
     <TabItem label="Verification code">
       <Steps>
         1. Create a form to collect the verification code
         2. Call the verification API when the form is submitted to verify the code
         3. Handle the response to either grant access or show an error
       </Steps>

       ```http showLineNumbers=false title="API endpoint"
       POST /api/v1/passwordless/email/verify
       ```

       **Example implementation**

       <Tabs syncKey='tech-stack'>
         <TabItem label="cURL" value="curl">
           ```sh ins={5,6} "/api/v1/passwordless/email/verify" title="Request" showLineNumbers=false wrap
           curl -L '<SCALEKIT_ENVIRONMENT_URL>/api/v1/passwordless/email/verify' \
           -H 'Content-Type: application/json' \
           -H 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsIm..' \
           -d '{
               "code": "123456",
               "auth_request_id": "YC4QR-dVZVtNNVHcHwrnHNDV..."
           }'
           ```
           <details>
             <summary>Request parameters</summary>
             | Parameters | Required | Description |
             |-----------|----------|-------------|
             | `code` | Yes | The verification code entered by the user <Badge variant="note" text="string" /> |
             | `auth_request_id` | Yes | The request ID from the response when the verification email was sent <Badge variant="note" text="string" /> |
           </details>

           <details>
             <summary>Response parameters</summary>
             | Parameters | Description |
             |-----------|-------------|
             | `email` | The email address of the user <Badge variant="note" text="string" /> |
             | `state` | The state parameter that was passed in the original request <Badge variant="note" text="string" /> |
             | `template` | The template that was used for the verification code <Badge variant="note" text="string" /> |
             | `passwordless_type` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
           </details>
         </TabItem>
         <TabItem label="Node.js" value="node">
           ```js wrap
           const { authRequestId } = sendResponse;
           const verifyResponse = await scalekit.passwordless
             .verifyPasswordlessEmail(
               { code: "123456"},
               authRequestId
             );

           // verifyResponse = {
           //   "email": "saifshine7@gmail.com",
           //   "state": "jAy-state1-gM4fdZdV22nqm6Q_j..",
           //   "template": "SIGNIN",
           //   "passwordless_type": "OTP" | "LINK" | "LINK_OTP"
           // }
           ```
           <details>
             <summary>Request parameters</summary>
             | Parameters | Required | Description |
             |-----------|----------|-------------|
             | `options.code` | Yes | The verification code received by the user <Badge variant="note" text="string" /> |
             | `authRequestId` | Yes | The unique identifier for the authentication request that was sent earlier <Badge variant="note" text="string" /> |
           </details>

           <details>
             <summary>Response parameters</summary>
             | Parameters | Description |
             |-----------|-------------|
             | `email` | The email address of the user <Badge variant="note" text="string" /> |
             | `state` | The state parameter that was passed in the original request <Badge variant="note" text="string" /> |
             | `template` | The template that was used for the verification code <Badge variant="note" text="string" /> |
             | `passwordlessType` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
           </details>
         </TabItem>
         <TabItem label="Python" value="python">
           ```python
           verify_response = client.passwordless.verify_passwordless_email(
               code="123456",  # OTP code received via email
               auth_request_id=auth_request_id,
           )

           # User verified successfully
           user_email = verify_response[0].email
           ```
         </TabItem>
           <TabItem label="Go" value="go">
             ```go
             // Verify with OTP code
             verifyResponse, err := scalekitClient.Passwordless().VerifyPasswordlessEmail(
                 ctx,
                 &scalekit.VerifyPasswordlessOptions{
                     Code:          "123456", // OTP code
                     AuthRequestId: authRequestId,
                 },
             )

             if err != nil {
                 // Handle error
                 return
             }

             // verifyResp contains the verified user's info
             // type VerifyPasswordLessResponse struct {
             //   Email            string
             //   State            string
             //   Template         string // SIGNIN | SIGNUP
             //   PasswordlessType string // OTP | LINK | LINK_OTP
             // }
             ```

             <details>
               <summary>Request parameters</summary>
               | Parameters | Required | Description |
               |-----------|----------|-------------|
               | `options.Code` | Yes | The verification code received by the user <Badge variant="note" text="string" /> |
               | `options.AuthRequestId` | Yes | The unique identifier for the authentication request that was sent earlier <Badge variant="note" text="string" /> |
             </details>

             <details>
               <summary>Response parameters</summary>
               | Parameters | Description |
               |-----------|-------------|
               | `Email` | The email address of the user <Badge variant="note" text="string" /> |
               | `State` | The state parameter that was passed in the original request <Badge variant="note" text="string" /> |
               | `Template` | The template that was used (`SIGNIN` or `SIGNUP`) <Badge variant="note" text="string" /> |
               | `PasswordlessType` | `OTP`, `LINK` or `LINK_OTP` <Badge variant="note" text="string" /> |
             </details>
           </TabItem>
           <TabItem label="Java" value="java">
             ```java
             // Verify with OTP code
             VerifyPasswordlessOptions verifyOptions = new VerifyPasswordlessOptions();
             verifyOptions.setCode("123456"); // OTP code
             verifyOptions.setAuthRequestId(authRequestId);

             VerifyPasswordLessResponse verifyResponse = passwordlessClient.verifyPasswordlessEmail(verifyOptions);

             // User verified successfully
             String userEmail = verifyResponse.getEmail();
             ```
           </TabItem>
       </Tabs>
     </TabItem>
     <TabItem label="Magic Link Verification">
       To support magic link verification, add a callback endpoint in your application typically atâ€¯<code>https://your-app.com/passwordless/verify</code>. Implement it to verify the magic link token and complete the user authentication process.

       <Steps>
         1. Create a verification endpoint in your application to handle the magic link verification. This is the endpoint that the user lands in when they click the link in the email.
         2. Capture the magic link token from the `link_token` request parameter from the URL.
         3. Call the verification API when the user clicks the link in the email.
         4. Based on token verification, complete the authentication process or show an error with an appropriate error message.
       </Steps>

       ```http showLineNumbers=false title="API endpoint"
       POST /api/v1/passwordless/email/verify
       ```

       **Example implementation**

       <Tabs syncKey='tech-stack'>
         <TabItem label="cURL" value="curl">
           ```sh ins={5,6} "/api/v1/passwordless/email/verify" title="Request" showLineNumbers=false
           curl -L '<SCALEKIT_ENVIRONMENT_URL>/api/v1/passwordless/email/verify' \
           -H 'Content-Type: application/json' \
           -H 'Authorization: Bearer eyJhbGciOiJSUzI1NiIsIm..' \
           -d '{
               "link_token": "a4143d8f-...c846ed91e_l",
               "auth_request_id": "YC4QR-dVZVtNNVHcHwrnHNDV..." // (optional)
           }'
           ```
           <details>
             <summary>Request parameters</summary>
             | Parameters | Required | Description |
             |-----------|----------|-------------|
             | `link_token` | Yes | The link token received by the user <Badge variant="note" text="string" /> |
             | `auth_request_id` | No | The request ID you received when the verification email was sent. <Badge variant="note" text="string" /> |

             <Aside type="caution" title="Auth request ID">
              If you use Magic Link or Magic Link + OTP and have enabled same browser origin enforcement in the Scalekit dashboard, it is required to include the auth request ID in your request.
            </Aside>
           </details>

           <details>
             <summary>Response parameters</summary>
             | Parameters | Description |
             |-----------|-------------|
             | `email` | The email address of the user <Badge variant="note" text="string" /> |
             | `state` | The state parameter that was passed in the original request <Badge variant="note" text="string" /> |
             | `template` | The template that was used for the verification code <Badge variant="note" text="string" /> |
             | `passwordless_type` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
           </details>
         </TabItem>
         <TabItem label="Node.js" value="node">
           ```js wrap showLineNumbers collapse={15-21}
           // User clicks the magic link in their email
           // Example magic link: https://yourapp.com/passwordless/verify?link_token=a4143d8f-d13d-415c-8f5a-5a5c846ed91e_l

           // 2. Express endpoint to handle the magic link verification
           app.get('/passwordless/verify', async (req, res) => {
             const { link_token } = req.query;

             try {
               // 3. Verify the magic link token with Scalekit
               const verifyResponse = await scalekit.passwordless
                 .verifyPasswordlessEmail(
                   { linkToken: link_token },
                   authRequestId // (optional) sendResponse.authRequestId
                 );

               // 4. Successfully log the user in
               // Set session/token and redirect to dashboard
               res.redirect('/dashboard');
             } catch (error) {
               res.status(400).json({
                    error: 'The magic link is invalid or has expired. Please request a new verification link.'
                });
             }
           });

           // verifyResponse = {
           //   "email": "saifshine7@gmail.com",
           //   "state": "jAy-state1-gM4fdZdV22nqm6Q_j..",
           //   "template": "SIGNIN",
           //   "passwordless_type": "OTP" | "LINK" | "LINK_OTP"
           // }
           ```
           <details>
             <summary>Request parameters</summary>
             | Parameters | Required | Description |
             |-----------|----------|-------------|
             | `options.linkToken` | Yes | The link token received by the user <Badge variant="note" text="string" /> |
             | `authRequestId` | No | The unique identifier for the authentication request that was sent earlier. <Badge variant="note" text="string" /> |
            <Aside type="caution" title="Auth request ID">
            If you use Magic Link or Magic Link + OTP and have enabled same browser origin enforcement in the Scalekit dashboard, it is required to include the auth request ID in your request.
            </Aside>
           </details>

           <details>
             <summary>Response parameters</summary>
             | Parameters | Description |
             |-----------|-------------|
             | `email` | The email address of the user <Badge variant="note" text="string" /> |
             | `state` | The state parameter that was passed in the original request <Badge variant="note" text="string" /> |
             | `template` | The template that was used for the verification code <Badge variant="note" text="string" /> |
             | `passwordlessType` | The type of passwordless authentication to use. Currently supports `OTP`, `LINK` and `LINK_OTP` <Badge variant="note" text="string" /> |
           </details>
         </TabItem>
         <TabItem label="Python" value="python">
         ```python
         # Verify with magic link token
         verify_response = client.passwordless.verify_passwordless_email(
             link_token=link_token,  # Magic link token from URL
             # auth_request_id=auth_request_id,  # optional if same-origin enforcement enabled
         )

         # User verified successfully
         user_email = verify_response[0].email
         ```
         </TabItem>
         <TabItem label="Go" value="go">
         ```go
         verifyResponse, err := scalekitClient.Passwordless().VerifyPasswordlessEmail(
             ctx,
             &scalekit.VerifyPasswordlessOptions{
                 LinkToken: linkToken, // Magic link token
             },
         )

         if err != nil {
             // Handle error
             return
         }

         // User verified successfully
         userEmail := verifyResponse.Email
         ```
         </TabItem>
         <TabItem label="Java" value="java">
         ```java
         // Verify with magic link token
         VerifyPasswordlessOptions verifyOptions = new VerifyPasswordlessOptions();
         verifyOptions.setLinkToken(linkToken); // Magic link token
         // verifyOptions.setAuthRequestId(authRequestId); // optional if same-origin enforcement enabled

         VerifyPasswordLessResponse verifyResponse = passwordlessClient.verifyPasswordlessEmail(verifyOptions);

         // User verified successfully
         String userEmail = verifyResponse.getEmail();
         ```
         </TabItem>
       </Tabs>
     </TabItem>
    </Tabs>

   <Aside type="caution" title="Validation attempt limits">
     To protect your application, Scalekit allows a user only **five** attempts to enter the correct OTP within a ten-minute window.
     If the user exceeds this limit for an <code>auth_request_id</code>, the <code>/passwordless/email/verify</code> endpoint returns an **HTTP&nbsp;429&nbsp;Too&nbsp;Many&nbsp;Requests** error.
     To continue, the user must restart the authentication flow.
   </Aside>

</Steps>

You've successfully implemented passwordless authentication in your application. Users can now sign in securely without passwords by entering a verification code or clicking a magic link sent to their email.
