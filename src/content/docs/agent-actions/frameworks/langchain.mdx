---
title: LangChain
description: Learn how to use LangChain with Agent Actions.

---

import { LinkCard, CardGrid, Aside, Steps, Tabs, TabItem } from '@astrojs/starlight/components';
import InstallSDK from '@components/templates/_installsdk.mdx';

This quickstart guide will help you build agents using Langchain Framework and add tool calling ability natively to the agent.

## What you'll build

In this quickstart, you'll build a simple integration that:

1. **Authenticates a user with GMail** to authenticate their Gmail account via OAuth 2.0
2. **Fetches last 5 unread emails** from the user's inbox

## Prerequisites

Before you start, make sure you have:

- **Scalekit API credentials** (Client ID and Client Secret)
- **Development environment** (Node.js, Python, or similar)

## Step 1: Set up your environment

First, install the Scalekit Python SDK and initialize the client with your API credentials:

<p>
  ```sh showLineNumbers=false frame="none"
  pip install scalekit-sdk-python
  ```
</p>
<p>
  ```python showLineNumbers=false frame="none"
  import scalekit.client
  import os

  scalekit = scalekit.client.ScalekitClient(
      client_id=os.getenv("SCALEKIT_CLIENT_ID"),
      client_secret=os.getenv("SCALEKIT_CLIENT_SECRET"),
      env_url=os.getenv("SCALEKIT_ENV_URL"),
  )
  actions = scalekit.actions

  ```
</p>

## Step 2: Create a connected account
Let's authorize a user to access their Gmail account by creating a connected account. This represents the user's connection to their Gmail account:

```python
# Create a connected account for user if it doesn't exist already
connected_account = actions.get_or_create_connected_account(
            connection_name="gmail",
            identifier="user_123"
        )

print(f'Connected account created: {connected_account.id}')
```

## Step 3: Authenticate the user

Inorder to execute any tools on behalf of the user, the user first needs to grant authorization to access their gmail account. Scalekit automatically handles the entire OAuth workflow with the Gmail provider, gets the access token, refreshes the access token periodically based on the refresh token etc.

If the user's access token is expired, Scalekit will automatically refresh the access token using the refresh token. At any time, you can check the authorization status of the connected account and determine if the user needs to re-authorize the connection.

```python
# If the user hasn't yet authorized the gmail connection or if the user's access token is expired, 
# generate a magic link and redirect the user to this link so that the user can complete authorization
if(connected_account.status != "ACTIVE"):
      link_response = actions.get_authorization_link(
          connection_name="gmail",
          identifier="user_123"
      )
      print(f"ðŸ”—click on the link to authorize gmail", link_response.link)
      input(f"âŽ† Press Enter after authorizing gmail...")

# In a real app, redirect the user to this URL so that the user can complete the authentication process for their gmail account
```

## Step 4: Build a Langchain Agent

Let's build a simple agent that can fetch the last 5 unread emails from the user's inbox and generate a summary of the emails.

1. Fetch the last 5 unread emails from the user's inbox
2. Generate a summary of the emails.

```python
from langchain_openai import ChatOpenAI
from langchain.agents import AgentExecutor, create_openai_tools_agent
from langchain_core.prompts import SystemMessagePromptTemplate, MessagesPlaceholder, HumanMessagePromptTemplate,PromptTemplate, ChatPromptTemplate

# use scalekit SDK to fetch all GMAIL tools in langchain format
tools =  actions.langchain.get_tools(
    identifier=identifier,
     providers = ["GMAIL"] # all tools for provider used by default
)

prompt = ChatPromptTemplate.from_messages([
    SystemMessagePromptTemplate(prompt=PromptTemplate(input_variables=[], template="You are a helpful assistant. Use tools if needed")),
    MessagesPlaceholder(variable_name="chat_history", optional=True),
    HumanMessagePromptTemplate(prompt=PromptTemplate(input_variables=["input"], template="{input}")),
    MessagesPlaceholder(variable_name="agent_scratchpad")
])

llm = ChatOpenAI(model="gpt-4o")
agent = create_openai_tools_agent(llm, tools, prompt)
agent_executor = AgentExecutor(agent=agent, tools=tools,verbose=True)
result = agent_executor.invoke({"input":"fetch my last 5 unread emails and summarize it"}
)
```

## Next steps

Congratulations! You've successfully built a langchain agent and gave it access to gmail tools to execute tool calls on behalf of a user based on the user's query.
