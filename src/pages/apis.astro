---
// Import the `<StarlightPage>` component first to set up cascade layers
import StarlightPage from '@astrojs/starlight/components/StarlightPage.astro'
import { ScalarComponent } from '@scalar/astro'
import ApiSearchIndex from '@/components/ApiSearchIndex.astro'

// Page metadata
const frontmatter = {
  title: 'Scalekit API Reference',
  description: 'Complete reference for all Scalekit API endpoints',
  template: 'splash',
  editUrl: false,
  head: [
    {
      tag: 'style',
      content: `
        footer {
          display: none !important;
        }
        .content-panel:first-of-type:has(.sl-container:empty),
        .content-panel:first-of-type:not(:has(.api-reference-wrapper)) {
          display: none !important;
        }
        .content-panel:first-of-type:empty {
          display: none !important;
        }
        .scalar-api-reference {
          position: sticky;
          top: var(--sl-nav-height);
          height: calc(100vh - var(--sl-nav-height));
          overflow: auto;
        }
        
        /* Hide Scalar's internal scrollbar to prevent double scrollbars */
        .scalar-api-reference ::-webkit-scrollbar {
          display: none;
        }
        .scalar-api-reference {
          -ms-overflow-style: none;
          scrollbar-width: none;
        }
      `,
    },
  ],
}
---

<div class="scalar-api-reference">
  <ScalarComponent
    configuration={{
      url: '/api/scalekit.swagger.json',
      theme: 'default',
      layout: 'modern',
      pageTitle: 'Scalekit API',
      hideTestRequestButton: true,
      withDefaultFonts: false,
      hideModels: true,
      searchHotKey: 'p',
      hideDarkModeToggle: true,
      darkMode: false,
      defaultOpenAllTags: false,
      hiddenClients: [
        'httpclient',
        'restsharp',
        'http1.1',
        'asynchttp',
        'okhttp',
        'jquery',
        'request',
        'unirest',
        'nsurlsession',
        'cohttp',
        'guzzle',
        'http',
        'ofetch',
        'http1',
        'http2',
        'restmethod',
        'httr',
        'httpie',
        'wget',
        'undici',
        'requests',
        'python3',
        'xhr',
        'fetch',
      ],
      favicon:
        'https://cdn.prod.website-files.com/65b87d98fa638289e10b8f61/67ab35acf2f180e0fe0a94a8_S%20Icon%20-%20Black%20-%2032x32.png',
      hideClientButton: true,
      baseServerURL: 'https://scalekit.com',
      documentDownloadType: 'json',
      defaultHttpClient: {
        targetKey: 'shell',
        clientKey: 'curl',
      },
    }}
  />
</div>

<StarlightPage frontmatter={frontmatter}>
  <!-- Hidden search index for Pagefind -->
  <div style="display: none;">
    <ApiSearchIndex />
  </div>
</StarlightPage>
